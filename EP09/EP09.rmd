---
title: "EP06"
author: "Equipo 6"
date: "2023-11-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggpubr)
```

Un estudio recolectó medidas anatómicas de 247 hombres y 260 mujeres (Heinz et al., 2003). El estudio incluyó nueve mediciones del esqueleto (ocho diámetros y una profundidad de hueso a hueso) y doce mediciones de grosor (circunferencias) que incluyen el tejido. La siguiente tabla detalla las variables registradas en este estudio:

1 Biacromial.diameter	    : Diámetro biacromial (a la altura de los hombros)	cm
2 Biiliac.diameter	      : Diámetro biiliaco (a la altura de la pelvis)	cm
3 Bitrochanteric.diameter	: Diámetro bitrocantéreo (a la altura de las caderas)	cm
4 Chest.depth           	: Profundidad del pecho (entre la espina y el esternón a la altura de los pezones)	cm
5 Chest.diameter	        : Diámetro del pecho (a la altura de los pezones)	cm
6 Elbows.diameter	        : Suma de los diámetros de los codos	cm
7 Wrists.diameter	        : Suma de los diámetros de las muñecas	cm
8 Knees.diameter	        : Suma de los diámetros de las rodillas	cm
9 Ankles.diameter	        : Suma de los diámetros de los tobillos	cm
10Shoulder.Girth	        : Grosor de los hombros sobre los músculos deltoides	cm
11Chest.Girth           	: Grosor del pecho, sobre tejido mamario en mujeres y a la altura de los pezones en varones	cm
12Waist.Girth	            : Grosor a la altura de la cintura	cm
13Navel.Girth	            : Grosor a la altura del ombligo	cm
14Hip.Girth             	: Grosor a la altura de las caderas	cm
15Thigh.Girth           	: Grosor promedio de ambos muslos bajo el pliegue del glúteo	cm
16Bicep.Girth	            : Grosor promedio de ambos bíceps, brazos flectados	cm
17Forearm.Girth	          : Grosor promedio de ambos antebrazos, brazos extendidos palmas hacia arriba	cm
18Knee.Girth	            : Grosor promedio de ambas rodillas, posición levemente flectada, medición arriba de la rótula	cm
19Calf.Maximum.Girth	    : Grosor promedio de la parte más ancha de ambas pantorrillas	cm
20Ankle.Minimum.Girth	    : Grosor promedio de la parte más delgada de ambos tobillos	cm
21Wrist.Minimum.Girth	    : Grosor promedio de la parte más delgada de ambas muñecas	cm
22Age	                    : Edad	Años
23Weight	                : Peso	Kg
24Height              	  : Estatura	cm
25Gender	                : Género	1: hombre
                                    0: mujer

```{r}
datos <- read.csv2("EP09 Datos.csv")
head(datos)

mujeres <- filter(datos, Gender == 0)

set.seed(1624)
muestra <- mujeres[sample(nrow(mujeres), 50), ]

predictores <- sample(24, 8)
predictores

muestraP <- muestra[predictores]
head(muestraP)
```

Se selecciona la variable Navel.Girth por ser la medida del grosor a la altura del ombligo, ayudando a medir el tamaño de la posible grasa abdominal.

```{r}
# Evaluación de variables
nulo <- lm(Weight ~ 1, data = muestra)
summary(nulo)

completo <- lm(Weight ~ ., data = muestra)
summary(completo)

add1(nulo, scope = completo)


#MLS
modelo <- lm(Weight ~ Navel.Girth, data = muestra)

p <- ggscatter(muestra, x = "Navel.Girth", y = "Weight", color = "blue", fill = "blue")
p <- p + geom_smooth(method = lm, se = FALSE, colour = "red")

p

summary(modelo)
plot(modelo)
```


          JUSTIFICAR CONDICIONES
          

```{r}
completo <- lm(Weight ~ Navel.Girth + Calf.Maximum.Girth + Age + Chest.diameter + Elbows.diameter + Shoulder.Girth + Chest.Girth + Bitrochanteric.diameter + Wrist.Minimum.Girth, data = muestra)
summary(completo)

add1(modelo, scope = completo)
modMejorado <- update(modelo, . ~ . + Calf.Maximum.Girth)
plot(modMejorado)
# Muere la normalidad
shapiro.test(modMejorado$residuals)

add1(modMejorado, scope = completo)
modMejorado <- update(modelo, . ~ . + Wrist.Minimum.Girth)
plot(modMejorado)
shapiro.test(modMejorado$residuals)

add1(modMejorado, scope = completo)
modMejorado <- update(modelo, . ~ . + Shoulder.Girth)
plot(modMejorado)
shapiro.test(modMejorado$residuals)

add1(modMejorado, scope = completo)

```



